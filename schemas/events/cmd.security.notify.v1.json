{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Security Command - Notify v1",
  "type": "object",
  "required": [
    "schema_urn",
    "action_id",
    "channel",
    "message",
    "requested_at"
  ],
  "properties": {
    "schema_urn": {
      "const": "urn:nc:schema:security:command:cmd.security.notify.v1"
    },
    "action_id": {
      "type": "string",
      "pattern": "^act_[0-9A-Za-z]{10,}$"
    },
    "channel": {
      "type": "string",
      "enum": ["email", "slack", "pagerduty"]
    },
    "recipients": {
      "type": "array",
      "items": {"type": "string"},
      "minItems": 1
    },
    "message": {"type": "string"},
    "requested_by": {"type": "string"},
    "requested_at": {"type": "string", "format": "date-time"}
  },
  "examples": [
    {
      "schema_urn": "urn:nc:schema:security:command:cmd.security.notify.v1",
      "action_id": "act_01J0AJ9Z03V6T8Y1",
      "channel": "slack",
      "recipients": ["#sec-ops-alerts"],
      "message": "Quarantine issued for doc_01HXYT (finding fin_01J0ABC7...). Status: queued.",
      "requested_by": "seg_automation",
      "requested_at": "2025-01-20T12:46:30Z"
    }
  ]
}
